package Scheduling_algos;

import java.util.Scanner;

class SJFProcess {
    int pid;   // Process ID
    int at;    // Arrival Time
    int bt;    // Burst Time
    int rt;    // Remaining Time
    int ct;    // Completion Time
    int tat;   // Turnaround Time
    int wt;    // Waiting Time
    boolean completed;

    SJFProcess(int pid, int at, int bt) {
        this.pid = pid;
        this.at = at;
        this.bt = bt;
        this.rt = bt; // remaining time initially = burst time
        this.completed = false;
    }
}

public class SJF_Preemptive {
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);

        System.out.println("\n--- Preemptive SJF (Shortest Remaining Time First) Scheduling ---");
        System.out.print("Enter number of processes: ");
        int n = sc.nextInt();
        SJFProcess[] p = new SJFProcess[n];

        for (int i = 0; i < n; i++) {
            System.out.print("Enter Arrival Time for P" + (i + 1) + ": ");
            int at = sc.nextInt();
            System.out.print("Enter Burst Time for P" + (i + 1) + ": ");
            int bt = sc.nextInt();
            p[i] = new SJFProcess(i + 1, at, bt);
        }

        int completed = 0, currentTime = 0, minRT, idx;
        double totalTAT = 0, totalWT = 0;

        while (completed < n) {
            idx = -1;
            minRT = Integer.MAX_VALUE;

            // Find process with smallest remaining time among arrived processes
            for (int i = 0; i < n; i++) {
                if (!p[i].completed && p[i].at <= currentTime && p[i].rt < minRT) {
                    minRT = p[i].rt;
                    idx = i;
                }
            }

            if (idx == -1) {
                currentTime++; // No process available yet
                continue;
            }

            // Execute process for 1 unit of time
            p[idx].rt--;
            currentTime++;

            // If process finishes
            if (p[idx].rt == 0) {
                p[idx].completed = true;
                p[idx].ct = currentTime;
                p[idx].tat = p[idx].ct - p[idx].at;
                p[idx].wt = p[idx].tat - p[idx].bt;
                totalTAT += p[idx].tat;
                totalWT += p[idx].wt;
                completed++;
            }
        }

        // Output
        System.out.println("\nPID\tAT\tBT\tCT\tTAT\tWT");
        for (int i = 0; i < n; i++) {
            System.out.println("P" + p[i].pid + "\t" + p[i].at + "\t" + p[i].bt + "\t" +
                               p[i].ct + "\t" + p[i].tat + "\t" + p[i].wt);
        }

        System.out.printf("\nAverage Turnaround Time = %.2f", (totalTAT / n));
        System.out.printf("\nAverage Waiting Time = %.2f\n", (totalWT / n));

        sc.close();
    }
}



INPUT
Enter number of processes: 4
Enter Arrival Time for P1: 0
Enter Burst Time for P1: 8
Enter Arrival Time for P2: 1
Enter Burst Time for P2: 4
Enter Arrival Time for P3: 2
Enter Burst Time for P3: 1
Enter Arrival Time for P4: 3
Enter Burst Time for P4: 2

PID     AT      BT      CT      TAT     WT
P1      0       8       15      15      7
P2      1       4       8       7       3
P3      2       1       3       1       0
P4      3       2       5       2       0

Average Turnaround Time = 6.25
Average Waiting Time = 2.50

